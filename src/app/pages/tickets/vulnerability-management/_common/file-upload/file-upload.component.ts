import { Component, EventEmitter, Input, OnInit, Output } from "@angular/core";
import { MatDialog } from "@angular/material/dialog";
import { ObjFile } from "src/app/core/model/db-ticket.model";

@Component({
  selector: "app-file-upload",
  templateUrl: "./file-upload.component.html"
})
export class FileUploadComponent implements OnInit {

  @Input() control: string;
  @Input() label: string = 'Subir archivo';
  @Output() onFile = new EventEmitter<ObjFile>();

  constructor(
    public dialog: MatDialog,
  ) { }

  ngOnInit(): void {
  }

  onFileSelected(files: FileList) {
    let file = files[0];
    let reader = new FileReader();
    reader.readAsDataURL(file);
    reader.onload = () => {
      console.log(file.name);
      let uploaded = { name: file.name, fileData: reader.result.toString().split(',').pop(), nameControl: this.control };
      this.onFile.emit(uploaded);
    };
    reader.onerror = (error) => {
      console.log('Error: ', error);
    };
  }
}
